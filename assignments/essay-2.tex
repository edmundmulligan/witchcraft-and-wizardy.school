\documentclass[a4paper, 12pt]{article}

% include required packages
\usepackage[T1]{fontenc}                   % Font encoding for special characters
\usepackage{pmboxdraw}                     % Support for box-drawing characters
\usepackage{booktabs}                      % For better table formatting
\usepackage{enumitem}                      % For customizing lists
\usepackage{float}                         % For [H] table placement
\usepackage[a4paper, margin=2cm]{geometry} % Set page margins
\usepackage{indentfirst}                   % Indent first paragraph of sections
\usepackage[utf8]{inputenc}                % UTF-8 input encoding
\usepackage{listings}                      % For code listings
\usepackage[round,authoryear]{natbib}      % For citations
\usepackage{tikz}                          % For drawing diagrams
\usepackage{url}                           % For formatting URLs
\usepackage{verbatim}                      % For including verbatim files
\usepackage{xcolor}                        % For colors
\usetikzlibrary{positioning}               % For relative positioning

% set paragraph and list formatting
\setlength{\parindent}{1.5em}
\setlength{\parskip}{0pt}
\setlist[itemize]{noitemsep,topsep=0pt,parsep=0pt,partopsep=0pt,after=\vspace{0.5em}}

% set title information
\title{A critical reflection on refactoring the Web Witchcraft and Wizardry project}
\author{Edmund Mulligan}
\date{\today}

% Configure listings for JSON
\lstdefinelanguage{json}{
    basicstyle=\small\ttfamily,
    numbers=left,
    numberstyle=\tiny,
    stepnumber=5,
    numbersep=8pt,
    showstringspaces=false,
    breaklines=true,
    frame=lines,
    backgroundcolor=\color{gray!10},
}

% document start
\begin{document}

% set bibliography style and page numbering
\bibliographystyle{plainnat}
\pagenumbering{arabic}

\maketitle

\begin{abstract}
\textit{This is a personal reflection on the design and implementation of a refactored version of a
website. The new architecture is described, along with the navigation design, responsive and
accessibility features, testing strategy, known issues and future improvements. Third party
credits and resources are also acknowledged.}
\end{abstract}

\section{Introduction}

Web Witchcraft and Wizardry \citep{mulligan2024witchcraftandwizardry} is a website for children  
to learn the basics of web development through fantasy-themed metaphors. The original version of 
the website was neither accessible (except by accident) nor responsive. This essay reflects on the 
design and implementation of a refactored version of the project, focusing on architecture, 
accessibility and quality of the new code. Detailed decisions are documented as comments in 
the source code, which should be read alongside this essay, so the essay focuses on higher level
design decisions and reflections.

For reference the old and new landing pages can be seen in 
figures~\ref{fig:old-landing-page},~\ref{fig:new-landing-page-computer} 
and~\ref{fig:new-landing-page-mobile}.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{screenshots/Original Website.png}
    \caption{Old landing page}\label{fig:old-landing-page}
\end{figure}

    \begin{figure}[H]
        \centering
        \includegraphics[width=0.8\textwidth]{screenshots/New-Landing-Page-Computer.png}
        \caption{New landing page on a computer}\label{fig:new-landing-page-computer}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.3\textwidth]{screenshots/New-Landing-Page-Mobile.jpg}
    \caption{New landing page on a mobile device}\label{fig:new-landing-page-mobile}
\end{figure}

The development process used was iterative and incremental \citep{beck2004extreme}, and 
while there are many criticisms of this approach, particularly around its lack of documentation, 
endless changes and lack of scalability to large teams (see, for example, \citealt{boehm2004balancing}), 
it was well suited to this small project with a single developer fulfilling all team roles.

This essay was written in parallel with the development of the website, so screenshots may 
not exactly reflect the final version of the code submitted for assessment, but are 
intended to illustrate the design decisions discussed.

\section{Architecture}
Even in a small project, software design principles are important to keep the code maintainable
and extensible \citep{gamma1994design}. The three main principles applied in this project were 
separation of concerns \citep{parnas1972criteria}, DRY (Don't Repeat Yourself) 
\citep{hunt1999pragmatic}, and self-documenting code \citep{martin2008clean}.
The first principle lead to the folder structure shown in 
figure~\ref{fig:directory-structure}. The second principle influenced the use of 
JavaScript to inject common elements (header, footer, in-page navigation) into each page 
at runtime, rather than duplicating the code in each HTML file. This also inspired the 
use of CSS variables to define common colours and other styles in one place, rather than
duplicating these values throughout the CSS files. The third principle was followed 
throughout the codebase with meaningful names for files, classes, etc.,
and comments where necessary to explain non-obvious decisions. A consistent naming convention
was used throughout, specifically kebab-case for file names, class names and IDs,
and camelCase for JavaScript variables and functions (although, admitedly, there is currently 
only one JavaScript function).

\begin{figure}[H]
    \centering
    \small
    \begin{verbatim}
root/
├── index.html
├── sitemap.xml
├── sitemap.xls
├── bin/
│   └── (build and test scripts)
├── images/
│   ├── (site images)
│   └── fontawesome/
│       └── (svg fontawesome icons)
├── pages/
│   ├── about.html
│   ├── glossary-and-faq.html
│   ├── license-and-credits.html
│   └── students.html
├── scripts/
│   ├── inject-header.js
│   ├── inject-footer.js
│   └── inject-in-page-navigation-*.js
└── styles/
    ├── main.css
    ├── noscript.css
    ├── components/
    │   ├── buttons.css
    │   ├── header-and-footer.css
    │   ├── navigation.css
    │   └── titles.css
    ├── media-queries/
    │   ├── about.css
    │   ├── header-and-footer.css
    │   ├── index.css
    │   ├── license-and-credits.css
    │   ├── navigation.css
    │   └── students.css
    │   └── titles.css
    └── pages/
        ├── about.css
        ├── glossary-and-faq.css
        ├── index.css
        ├── license-and-credits.css
        └── students.css
    \end{verbatim}
    \caption{Directory structure of the project}\label{fig:directory-structure}
\end{figure}

\section{Navigation}
Navigation design was kept simple with a top navigation bar for site-wide navigation 
(figure~\ref{fig:site-navigation}) and an in-page navigation bar for navigating 
within all pages except the landing page (e.g.~figure~\ref{fig:in-page-navigation}, 
although each page is slightly different). Incidentally, the wizard and witch in the 
site header are informally known to the development team as `Joe' and `Helena' respectively.

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{screenshots/site-navigation.png}
    \caption{Site navigation bar structure}\label{fig:site-navigation}
\end{figure}

\begin{figure}[H]
    \centering
    \includegraphics[width=0.8\textwidth]{screenshots/in-page-navigation.png}
    \caption{In-page navigation bar structure}\label{fig:in-page-navigation}
\end{figure}  

\section{A Responsive and Accessibile Website}
A primary goal of the refactor was to make the website responsive and accessible.
Indeed, this is my main personal learning outcome for this module. My thinking 
in this area has been highly influenced by two YouTube channels, those of Kevin Powell 
\citep{powell_youtube} and Coding2GO \citep{coding2go_youtube}, both of whom produce 
 video tutorials and discussions on modern web development techniques.

The primary techniques used to achieve responsiveness are media queries and
flexible layouts \citep{marcotte2010responsive}. Accessibility features were 
mainly implemented by ensuring the code conformed to web standards, 
\citep{caldwell2024}, but also by following best practices in the 
HTML markup, such as using semantic HTML elements \citep{w3c_html5},

\subsection{Using and avoiding media queries}
A point Powell makes in several videos is that while media queries are 
important, they should not be overused. The main layout should be flexible
enough to adapt to a wide range of viewport sizes without the need for
frequent breakpoints. Exactly which breakpoints to use is a matter of 
experience (which I lack) and judgement (which I possess in abundence), 
and I eventually settled on the following standardised breakpoints across 
all pages:

\begin{table}
\centering
\begin{tabular}{|l|l|p{6cm}|}
\hline
\textbf{Viewport width} & \textbf{Layout} & \textbf{Impact}\\
\hline
0px to 80px & Too small to be useable & \\
\hline
81px to 200px & Very small & Warn users but make best effort to display contents reasonably \\
\hline
201px to 800px & Mobile layout & Prefer vertical stacking \\
\hline
801px and above & Desktop layout & Prefer horizontal layout \\
\hline
\end{tabular}
\caption{Viewport width breakpoints}
\label{tab:viewport-breakpoints}
\end{table}

In order to minimise the use of media queries, I used the clamp() CSS function 
to define fluid typography that scales smoothly between
a minimum and maximum size, rather than jumping between discrete sizes at
breakpoints. A limitation of this is that if the middle value of clamp() is
defined using a viewport width unit (vw), then the text will not scale if 
the user zooms their browser without changing the viewport window size. 
This contravenes WCAG 2.2 Success Criterion 1.4.4 \citep{caldwell2024} which 
requires text to be resizable up to 200\% without loss of content or 
functionality. A clever workaround recommended by Powell is to calculate the 
middle value of clamp() from a vw unit and 
a rem unit, so that zooming the browser window also changes the text size.

One downside of this approach is that it takes a lot of trial and error
to find suitable values to pass to clamp() that work well across a wide range of
viewport sizes and this took up most of my testing time. Indeed, I would say that
this is still a work in progress and further refinements could be made in future phases.

\subsection{Flexbox vs Grid}

\subsection{Units of measurement}
Another way to achieve responsiveness is to use relative units of measurement
rather than absolute units. Thus, I used rem units for font sizes, padding
and margins, and percentages for widths of containers. I avoided using px units
except where absolutely necessary such as in media queries where absolute measurements 
are required. I preferred rem units over em units as rems are relative to the root 
font size, making them more predictable, whereas ems are relative to the font size of
the parent element, which can lead to unexpected results if not carefully managed.

\subsection{Other accessibility features}
ARIA roles and attributes

choice of colours and contrasts

keyboard navigation

alt text for images

\section{Testing}
Testing software is not only a critical part of development 
(\cite{myers2011art},\cite{mesbah2012invariant}), but it is also difficult and 
time consuming. Many authorities (e.g. \cite{boehm1981software}, \cite{jones2008applied})
claim that testing can take at least 50\% of total development time, and that concurs with 
my experience.

My approach to testing was to automate as much as possible using
open source tools (see Appendix A for results). The tests were designed to check for compliance 
with web standards (as a proxy for accessibility) and (given the age of the target users) text 
readability. Both static and dynamic tesing tools \citep{myers2011art} were used \textemdash{} 
static tools to check code validity, and dynamic tools to check accessibility of the rendered pages.

The tests were run frequently during development to catch issues early and ensure that the 
code remained compliant as code was refactored (regression testing). A github action was 
written to ensure the tests were run whenver code was pushed to the remote development and 
main branches in github. Testing tools were discovered using a google search and the most 
popular ones were chosen:

\begin{itemize}
    \item Lighthouse \citep{lighthouse2025}
    \item Axe \citep{axe2025}
    \item Pa11y \citep{pa11y5}
    \item Wave \citep{wave2025} 
\end{itemize}

A script to check reading age using the Flesch-Kincaid formula 
\citep{flesch1948new} and Gunning Fog index \citep{gunning1952technique} 
was developed using the text-readability node.js module \citep{textreadability2025}. 
Code was checked for validity using node.js modules html-validate \citep{htmlvalidate2025},
stylelint \citep{stylelint2025} and eslint \citep{eslint2025}. The official W3C 
validator for CSS \citep{w3c_css_validator} was not used as this cannot currently validate 
code with CSS variables. A simple script was written to ensure all files contained valid 
header comments. Browser compatibility was tested using Playwright \citep{playwright2025} to 
run tests in multiple browsers and I acknowledge, with thanks, the assistance I received to 
get this working from a senior tester colleague at TfL. This allowed automated testing of 
the latest versions af all three major browser engines (Chrome, Firefox and Safari). 
Playwright has potential for much more and could enable a test driven 
developmeent (TDD) \citep{beck2003test} approach in future phases of this project.

Implementing Wave testing was the most difficult as it requires a public URL to test and 
github pages are based on a private repository. Making the github repository public was 
considered and rejected as it could introduce unanticipated security risks so, after 
consultation with testing colleagues, ngrok \citep{ngrok2025} was used to expose the 
localhost to allow Wave tests to complete.

There was insufficient time to fully evaluate the third party tools used and decide which 
was the best for this project, so a `black box' approach was taken without investigaing exactly 
what each tool was testing. This did have the benefit that gaps in one tool's coverage 
could potentally be caught by one of the other tools, but it did introduce a problem of 
tools having conflicting standards. Wave, in particular requires the <h1> element to be in 
the <main> section, which would mean that the site title in the <header> section would have to 
be either an <h2> or a <p> element, which would be flagged by the other testing tools. Thus 
a decision to accept the warning from Wave was taken as the least bad alternative. The other 
alert from Wave was for the use of <noscript>, but this was simply a warning to check this 
usage as it may have accessibility implcations.

Automated testing is not a substitute for manual testing, and the site was also tested manually
on a variety of devices, specifically

\begin{itemize}
    \item A computer with a mouse and keyboard (running Linux Mint)
    \item A computer without using a mouse (to test keyboard navigation)
    \item A computer with a screen reader (Linux Orca)
    \item A touchscreen tablet device without mouse or keyboard (running Android)
    \item A mobile phone (running Android)
\end{itemize}

I did not have access to an iOS device so could not test on Apple hardware.

I did not test the website with JavaScript disabled and this is I acknowlege this as a limitation
of the current testing, driven by the available time. Security, performance, and user testing 
were also not possible within the time constraints, but will be essential in the later phases 
where actual lessons are implemented and students' data are collected. In particular, expert 
testing from an experienced teacher will be needed to ensure the content is age appropriate 
and pedagogically sound.

\section{Outstanding issues and Future Improvements}
The poject submitted for assessment is phase one of a larger project to refactor and
improve the Web Witchcraft and Wizardry website. Some content was deliberatly ommitted 
from this phase as it will be developed in phase 2 using JavaScript. There are also 
some known issues and areas for improvement that could not be addressed within the
time constraints of this phase.

\begin{table}[h]
\centering
\begin{tabular}{|l|p{4cm}|p{4cm}|p{4cm}|}
\hline
\textbf{Issue Id} & \textbf{Description} & \textbf{Symptoms} & \textbf{Work around} \\
\hline
1 & Reactive code does not work well at extreme viewport sizes & Text overflows boxes or 
content does not fill screen properly. & Warning displayed when viewport is too small. \\
\hline
2 & Font sizes are not optimal & Text is too small or too large on some devices. & Further 
refinement of clamp() values needed. \\
\hline
3 & Images need editing. The artwork provided by Rachel Mulligan is in JPEG format with 
a white background. & The picture gallery looks unprofessional with white boxes around images. &
Images need to be edited to have transparent backgrounds (PNG or SVG format). \\
\hline
\end{tabular}
\caption{Known issues and workarounds}
\label{tab:bugs}
\end{table}

\section{Third party credits and resources}
All code submitted for assessment is my own work. No code has been copied from 
any external sources, such as online tutorials or code. I have, however, relied 
heavily on two YouTube channels, those of Kevin Powell \citep{powell_youtube} and 
Coding2GO \citep{coding2go_youtube}, for guidance on best practices and inspiration.

No Generative AI was used in creating code for this project, but I did make extensive 
use of Google Search which automatically generates AI summaries that cannot be disabled. 
I partly mitigated this by using Google Scholar where appropriate which at the moment 
does not use user accessible AI. I also used Stack Overflow \citep{stackoverflow2025} 
to troubleshoot specific issues I encountered.

The automation tools used for testing accessibility and performance (Lighthouse, Axe, 
pa11y, Wave) are all open source tools developed by third parties and the scripts used 
to run them were adapted from examples found in their respective documentations and in 
online resources. I was assisted by a colleague at my employer, Transport for London, 
in writing the playwright tests used for testing browser compatibility.

The artwork used in the website was created by Rachel Mulligan, a professional 
stained glass artist. I am grateful to her for allowing me to use her work in this 
project.

\section{Conclusion}
This has been a challenging and rewarding project. The challeng has not been coding the 
website, as I have 40 years of experience doing that, but in learning a lot of new 
material around modern CSS in a short space of time and applying that in a standards based 
development paradigm. The refactored Web Witchcraft and Wizardry website, while not yet 
complete, is a significant improvement on the original version in terms of accessibility, 
responsiveness and code quality. The use of automated testing has helped ensure that the 
code meets web standards and is accessible to the target audience. There are still some 
outstanding issues and areas for improvement that will be addressed in future phases of 
the project.

% Include word count N.B. Run wordcount.sh to generate wordcount.txt before compiling
\section*{Word count}
Word count: \input{wordcount.txt} words (excluding references)
\\
\bibliography{EdmundLibrary}

% include appendix
\newpage
\appendix
\section*{Appendices}
\input{essay-2-appendix.tex}

\end{document}
